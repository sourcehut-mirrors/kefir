pkgname='kefir'
pkgver='0.3.1'
pkgrel='1'
pkgdesc='C17 language compiler for x86_64 systems'
arch=('x86_64')
url='https://git.sr.ht/~jprotopopov/kefir'
license=('GPL3' 'BSD')

depends=()
makedepends=()
source=('kefir::git+https://git.sr.ht/~jprotopopov/kefir#tag=v0.3.1')
sha512sums=('SKIP')
options=('staticlibs')

build () {
    cd kefir
    make all PROFILE=release EXTRA_CFLAGS="-march=native"
}

package () {
    cd kefir
    make prefix="$pkgdir/usr/" install
    install -Dm644 COPYING "$pkgdir/usr/share/licenses/$pkgname/COPYING"
    install -Dm644 source/runtime/LICENSE "$pkgdir/usr/share/licenses/$pkgname/runtime/LICENSE"
    install -Dm644 dist/README.license "$pkgdir/usr/share/licenses/$pkgname/README"
}