.att_syntax
.section .note.GNU-stack,"",%progbits

.global clear
.type clear, @function
.global test_and_set
.type test_and_set, @function
.global test_sync_synchronize
.type test_sync_synchronize, @function

.section .text
__kefir_text_section_begin:
clear:
__kefir_text_func_clear_begin:
    xor %eax, %eax
    xchgb %al, (%rdi)
    ret
__kefir_text_func_clear_end:

test_and_set:
__kefir_text_func_test_and_set_begin:
    mov $1, %rax
    xchgb (%rdi), %al
    test %al, %al
    setne %al
    movzx %al, %rax
    ret
__kefir_text_func_test_and_set_end:

test_sync_synchronize:
__kefir_text_func_test_sync_synchronize_begin:
    lock     orq $0, (%rsp)
    ret
__kefir_text_func_test_sync_synchronize_end:

__kefir_text_section_end:

